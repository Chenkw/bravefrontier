<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="description" content="Brave Frontier - Sprite Fiddle - A community effort by Brave Frontier PROs" />
    <meta name="author" content="Sam GreenPuck" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Brave Frontier - Sprite Fiddle - by Brave Frontier PROs</title>
    <link rel="shortcut icon" href="https://googledrive.com/host/0B4hJr8BXxvFZZVVOZWswdnlnYTg/iconavatar128.png" />
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
<!-- Custom CSS -->
<style type="text/css">
    .clear {clear:both;}
    .bd {
        font-weight:bold;
        background:#EEEEEE;
        text-transform:uppercase;
    }
    .upper {
        text-transform:uppercase;
    }

#spriteBG {
	margin:0px auto 10px auto;
	width:640px;
	height:440px;
	position:inherit;
	background: transparent url('https://googledrive.com/host/0B4hJr8BXxvFZWmxjWm8zZjVVNVE/bg_dungeon_vocaloids.jpg') 0 0 no-repeat;
}

#spriteMother {
	margin:0px auto 0px auto;
	position:inherit;
	top:150px;
	border:1px solid #EEEEEE;
}
.sprite {
	position:absolute;
}

</style>
<!-- START JSON Code-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="//touchandswipe.github.io/bravefrontier/js/jquery.keyframes.min.js"></script>
</head>

<!-- MAIN BODY CONTENT -->
<body>
    <!-- Static navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="//bravefrontierpros.tumblr.com/"><img src="https://googledrive.com/host/0B4hJr8BXxvFZZVVOZWswdnlnYTg/iconavatar64.png" class="img-circle" style="max-width:64px; margin-top: -7px;" width="32"/> Brave Frontier PROs</a>
        </div>
        <!-- Collapse Nav-->
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
                    <li><a href="//bravefrontierpros.tumblr.com/chatroomunified"><i class="fa fa-comments-o"></i> Chat</a></li>
                    <li><a href="unitsguide.html"><i class="fa fa-female"></i><i class="fa fa-male"></i> Units DB</a></li>
                    <li><a href="fusionxpcalculator.html"><i class="fa fa-cogs"></i> Fusion XP Calc</a></li>
                    <li><a href="//bravefrontierpros.tumblr.com/mostwanted"><i class="fa fa-info"></i> Most wanted</a></li>
                    <li><a href="//bravefrontierpros.tumblr.com/youtubechannel"><i class="fa fa-youtube"></i> YouTube</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

<!-- Main Body Space-->
<div class="container">
	<div style="min-height:55px;"></div>
	<div class="row text-center">
		<div class="col-xs-12 text-center"><h1>Brave Frontier Sprite Fiddle (Beta)</h1></div>
	</div>
	<div class="row text-center">
		<div class="col-xs-12 text-center">
			<div id="spriteBG">
				<div  id="spriteMother">
					<div id="sprite1" class="sprite"></div>
				</div>
			</div>
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-12 text-center">
			<button class="btn btn-lg btn-default" id="animateStop">Stop</button>
			<button class="btn btn-lg btn-success" id="animateStart">Reset & Play</button>
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-12 text-center">
			<h3>Sprite ID <small>(<a href="#" id="spriteURL">Sprite datasheet</a>)</small></h3>
		</div>
		<div class="col-xs-12 text-center">
			<input type="text" class="form-control" id="spriteID" value="50645">
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-6 text-center">
			<h4><b>Width</b></h4>
			<div class="input-group">
      				<span class="input-group-btn">
        				<button class="btn btn-default btn-danger modWidth" value="-1" type="button"><i class="fa fa-minus"></i></button>
        				<button class="btn btn-default btn-success modWidth" value="1" type="button"><i class="fa fa-plus"></i></button>
      				</span>
				<input type="text" class="form-control" id="sizeX"></div>
			</div>
		<div class="col-xs-6 text-center">
			<h4><b>Height</b></h4>
			<div class="input-group">
      				<span class="input-group-btn">
        				<button class="btn btn-default btn-danger modHeight" value="-1" type="button"><i class="fa fa-minus"></i></button>
        				<button class="btn btn-default btn-success modHeight" value="1" type="button"><i class="fa fa-plus"></i></button>
      				</span>
				<input type="text" class="form-control" id="sizeY"></div>
		</div>
	</div>
</div><!--End 1st Container-->
<div class="container" id="spriteConfigHolder"></div>
<div class="container" style="margin-top:10px;">
	<div class="row">
		<div class="col-xs-12">
			<button class="btn btn-default btn-lg" type="button" id="addLayer" style="width:100%;"><i class="fa fa-plus"></i> Add new layer</button>
		</div>
	</div>
</div>
<!--Template hidden-->
<div class="container" id="spriteLayerTemplate">
	<div class="row text-center">
		<div class="col-xs-12 text-center">
			<h4 class="layerHead">Template ONLY - To be hidden in future </h4>
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-2 text-center">
			<h4><b>1st</b></h4>
		</div>
		<div class="col-xs-5 text-center">
			<input type="text" class="form-control" value="0" id="f1X">
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f1Y">
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-2 text-center">
			<h4><b>2nd</b></h4>
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f2X">
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f2Y">
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-2 text-center">
			<h4><b>3rd</b></h4>
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f3X">
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f3Y">
		</div>
	</div>
	<div class="row text-center">
		<div class="col-xs-2 text-center">
			<h4><b>4th</b></h4>
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f4X">
		</div>
		<div class="col-xs-5 text-center">
		      	<input type="text" class="form-control" value="0" id="f4Y">
		</div>
	</div>
</div> <!-- spriteLayerTemplate -->

<script type="text/javascript">
defaultWidth=168;
defaultHeight=136;

function grabTemplate() { /*Grab Template*/
	var len = $('.spriteLayers').length;
	var $html = $('#spriteLayerTemplate').clone();
	$(".layerHead", $html).html("<b>Layer "+(len+1)+":</b> Adjust position of each frame");
	/*Change ID of 4 frames each layer*/
	for (i=1;i<5;i++) {
		$("#f"+i+"X",$html).attr("id","#f"+i+"X_Layer"+(len+1));
		$("#f"+i+"Y",$html).attr("id","#f"+i+"Y_Layer"+(len+1));
	}
    	//$html.find('[id=layerHead]')[0].html("Layer "+len+": Adjust position of each frame");
	//$html.find('[name=lastname]')[0].name="lastname" + len;
	return $html.html();    
}

function addNewLayer() { /*Adds new layer on top*/
	var len = $('.sprite').length;
	var $cloneSpriteDiv = $('#sprite1').clone().attr('id','sprite'+(len+1)).css({"background":"#FF0000"}).appendTo('#spriteMother');
}

function playSprite() {
	//for (i in $('.sprite').length)
	var len = $('.sprite').length;
	for (i=1;i<=len;i++) {
		$("#sprite"+i).css("-webkit-animation","spriteAnimate_"+i+" 0.8s steps(1) infinite");
	}
}

function resetsPlays() {
	var layerProp=[];
	/*Grabs no. of layers*/
	var len = $('.spriteLayers').length;
	/*Grabs new dimension*/
	setSpriteSize($("#sizeX").val(),$("#sizeY").val());
	/*Grabs Value from Inputs*/
	alert($("#f1X_Layer1").val());
	for (i=1;i<=len;i++) {
		var f1Prop={'X':$("#f1X"+"_Layer"+i).val()+'px', 'Y':$("#f1X"+"_Layer"+i).val()+'px'};
		var f2Prop={'X':$("#f2X"+"_Layer"+i).val()+'px', 'Y':$("#f2X"+"_Layer"+i).val()+'px'};
		var f3Prop={'X':$("#f3X"+"_Layer"+i).val()+'px', 'Y':$("#f3X"+"_Layer"+i).val()+'px'};
		var f4Prop={'X':$("#f4X"+"_Layer"+i).val()+'px', 'Y':$("#f4X"+"_Layer"+i).val()+'px'};
		layerProp.push({'f1':f1Prop, 'f2':f2Prop, 'f3':f3Prop, 'f4':f4Prop });
		//var f1Prop={'background-position':$(f1X).val()+'px '+$(f1Y).val()+'px'};
		//var f2Prop={'background-position':$(f2X).val()+'px '+$(f2Y).val()+'px'};
		//var f3Prop={'background-position':$(f3X).val()+'px '+$(f3Y).val()+'px'};
		//var f4Prop={'background-position':$(f4X).val()+'px '+$(f4Y).val()+'px'};
	}
	
	/*Define / Re-Define position*/
	alert(JSON.stringify(layerProp[0]));
	for (i=1;i<=len;i++) {
		var layerName = 'spriteAnimate_'+i;
		$.keyframe.define([{
			name: layerName,
			'0%': {'background-position': layerProp[i-1].f1.X+'px '+layerProp[i-1].f1.Y+'px'},
			'33%': {'background-position': layerProp[i-1].f2.X+'px '+layerProp[i-1].f2.Y+'px'},
			'67%': {'background-position': layerProp[i-1].f3.X+'px '+layerProp[i-1].f3.Y+'px'},
			'100%': {'background-position': layerProp[i-1].f4.X+'px '+layerProp[i-1].f4.Y+'px'}
		}]);
	}
	
	$('.sprite').each(function( e ) {
		$(this).css("-webkit-animation","");
	})
	/*quirk to make animation reset*/
	document.getElementsByClassName("sprite").offsetWidth = document.getElementsByClassName("sprite").offsetWidth;
	playSprite();
}

function setSpriteSize(dX,dY) {
	/*Assigns default*/
	$('#spriteMother').css({"width":dX+"px","height":dY+"px"});
	$('.sprite').each(function( e ) {
		$(this).css({"width":dX+"px", "height":dY+"px", "background": "transparent url('http://v2.cdn.android.brave.a-lim.jp/unit/img/unit_anime_"+$('#spriteID').val()+".png') 0 0 no-repeat"});
		$("#sizeX").val(dX);
		$("#sizeY").val(dY);
		for (i=1;i<5;i++) {
			selectorX="#f"+i+"X";
			selectorY="#f"+i+"Y";
			$(selectorX).val(parseInt(i-1)*dX*-1);
			if ($(selectorY).val()=="")
				$(selectorY).val(0);
		}
	})
		$('#spriteURL').attr("href","http://v2.cdn.android.brave.a-lim.jp/unit/cgg/unit_cgg_"+$('#spriteID').val()+".csv")
}

$(document).ready( function(e) {
	setSpriteSize(defaultWidth,defaultHeight);
	/*Add animation*/
	$.keyframe.define([{
		name: 'spriteAnimate_1',
		'0%': {'background-position': '-5px 0px'},
		'33%': {'background-position': '-170px 8px'},
		'67%': {'background-position': '-333px 10px'},
		'100%': {'background-position': '-499px 6px'}
	}]);
	playSprite();
	//$('#sprite').css("-webkit-animation","spriteAnimate_1 0.8s steps(1) infinite");
	/*load initial config layers*/
	$('<div/>', {'class' : 'spriteLayers', html: grabTemplate() }).removeAttr('id').appendTo('#spriteConfigHolder');
	
     	$('#addLayer').on("click", function () {
     		//alert("Adding layer");
		$('<div/>', {'class' : 'spriteLayers', html: grabTemplate()
		}).hide().appendTo('#spriteConfigHolder').slideDown('slow');//Get the html from template and hide and slideDown for transtion.
		addNewLayer();
     	})
}) /*End DocReady*/

/*Stop Animation*/
$(document).on("click", '#animateStop', function(e){
	/*Resets*/
	$('.sprite').css("-webkit-animation","");
})

/*Resets & Plays Animation*/
$(document).on("click", '#animateStart', function(e){
	resetsPlays()
})

/*Modify width*/
$(document).on("click", '.modWidth, .modHeight', function(e){
	var dVal=parseInt($(this).val());
	if ($(this).hasClass('modWidth'))
		$('#sizeX').val(parseInt($('#sizeX').val())+dVal);
	else
		$('#sizeY').val(parseInt($('#sizeY').val())+dVal);
	resetsPlays()
})
</script>

<!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    
      ga('create', 'UA-48617906-1', 'tumblr.com');
      ga('send', 'pageview');
    </script>
<!--Chatroom-->
<script id="sid0020000056109341636">(function() {function async_load(){s.id="cid0020000056109341636";s.src='http://st.chatango.com/js/gz/emb.js';s.style.cssText="width:400px;height:500px;";s.async=true;s.text='{"handle":"bravefrontierpros","arch":"js","styles":{"a":"cc33cc","b":51,"c":"ffffff","d":"ffffff","e":"ffffff","g":"202020","k":"cc33cc","l":"77eecc","m":"cc66cc","q":"cc33cc","r":51,"t":0,"pos":"bl","cv":1,"cvfnt":"\'Helvetica Neue\', Helvetica, Arial, sans-serif, sans-serif","cvfntsz":"10pt","cvfntw":"bold","cvbg":"cc66cc","cvw":75,"cvh":40,"sbc":"66ddbb","surl":0,"cnrs":"0.35"}}';var ss = document.getElementsByTagName('script');for (var i=0, l=ss.length; i < l; i++){if (ss[i].id=='sid0020000056109341636'){ss[i].id +='_';ss[i].parentNode.insertBefore(s, ss[i]);break;}}}var s=document.createElement('script');if (s.async==undefined){if (window.addEventListener) {addEventListener('load',async_load,false);}else if (window.attachEvent) {attachEvent('onload',async_load);}}else {async_load();}})();</script>
</body>
</html>
